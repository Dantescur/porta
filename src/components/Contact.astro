<section id="contact" class="py-16 sm:py-20">
  <div class="container mx-auto px-6 sm:px-8 lg:px-12">
    <h2
      class="text-3xl sm:text-4xl font-bold mb-8 sm:mb-12 text-accent text-center"
    >
      Get in Touch
    </h2>

    <form id="contact-form" class="max-w-xl mx-auto space-y-6">
      <!-- Name Field -->
      <div>
        <label for="senderName" class="block text-sm font-medium text-text"
          >Name</label
        >
        <input
          type="text"
          id="senderName"
          name="senderName"
          required
          class="mt-2 block w-full rounded-lg border border-border bg-surface px-4 py-2 text-text shadow-sm focus:border-accent focus:ring-accent"
        />
      </div>

      <!-- Email Field -->
      <div>
        <label for="email" class="block text-sm font-medium text-text"
          >Email</label
        >
        <input
          type="email"
          id="email"
          name="email"
          required
          class="mt-2 block w-full rounded-lg border border-border bg-surface px-4 py-2 text-text shadow-sm focus:border-accent focus:ring-accent"
        />
      </div>

      <!-- Message Field -->
      <div>
        <label for="message" class="block text-sm font-medium text-text"
          >Message</label
        >
        <textarea
          id="message"
          name="message"
          rows="5"
          required
          class="mt-2 block w-full rounded-lg border border-border bg-surface px-4 py-2 text-text shadow-sm focus:border-accent focus:ring-accent"
        ></textarea>
      </div>

      <!-- Submit Button -->
      <div class="text-center">
        <button
          type="submit"
          class="inline-block px-6 py-3 text-sm font-medium rounded-lg bg-accent text-background shadow-lg hover:bg-accent/90 transition-colors"
        >
          Send Message
        </button>
      </div>
    </form>
  </div>

  <!-- EmailJS Script -->
  <script>
    import emailjs from "@emailjs/browser";

    emailjs.init({
      publicKey: "aIbWJhVe_r-PuJlau",
      blockHeadless: true,
      limitRate: {
        id: "app",
        throttle: 10000,
      },
    });

    const form = document.getElementById("contact-form") as HTMLFormElement;
    const submitBtn = form?.querySelector<HTMLButtonElement>(
      'button[type="submit"]'
    );

    if (form && submitBtn) {
      form.addEventListener("submit", async (event) => {
        event.preventDefault();

        submitBtn.disabled = true;
        submitBtn.innerHTML = "Sending...";

        if (!form.email.value.includes("@")) {
          alert("Please enter a valid email address");
          submitBtn.disabled = false;
          submitBtn.innerHTML = "Send Message";
          return;
        }

        try {
          const response = await emailjs.send(
            "service_pyxr4fe",
            "template_5tbfavo",
            {
              name: form.senderName.value,
              email: form.email.value,
              message: form.message.value,
            }
          );
          alert("Message sent successfully!");

          form.reset();
        } catch (error) {
          alert("Failed to send message.");
        } finally {
          submitBtn.disabled = false;
          submitBtn.innerHTML = "Send Message";
        }
      });
    }
  </script>
</section>
